"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var PCOPageExpired=function(){function e(t){var n=t.currentPersonACID,o=t.env,r=t.withAlert;_classCallCheck(this,e),this.currentPersonACID=n,this.env=o,this.withAlert=r,this.Swal="undefined"!=typeof Swal?Swal:"undefined"!=typeof swal?swal:void 0}return _createClass(e,[{key:"defaultConfig",get:function(){return{allowOutsideClick:!1,allowEscapeKey:!1,icon:"info",showCancelButton:!1}}},{key:"isProduction",get:function(){return"production"===this.env}},{key:"isStaging",get:function(){return"staging"===this.env}},{key:"iframeSource",get:function(){return this.isProduction?"https://pco-cross-storage.s3.amazonaws.com/hub.html":this.isStaging?"https://pco-cross-storage-staging.s3.amazonaws.com/hub.html":"https://pco-cross-storage-dev.s3.amazonaws.com/hub.html"}},{key:"loggedOutConfig",get:function(){return _objectSpread(_objectSpread({},this.defaultConfig),{},{confirmButtonText:"Log in",text:"You've logged out in another tab.",title:"Logged Out"})}},{key:"pcoSwal",get:function(){return this.Swal.hasOwnProperty("alert")}},{key:"refreshConfig",get:function(){return _objectSpread(_objectSpread({},this.defaultConfig),{},{confirmButtonText:"Refresh Page",text:"You've logged in to a different organization in another tab.",title:"Switched Account"})}},{key:"swalV1",get:function(){return this.Swal.prototype.constructor.hasOwnProperty("showInputError")}},{key:"swal2v9Plus",get:function(){return void 0!==this.Swal.version}},{key:"createIframe",value:function(){var e=this,t=document.createElement("iframe");t.style.cssText="height: 0px; width: 0px; opacity: 0; position: absolute; left: -1000px; top: -1000px;",t.src=this.iframeSource,t.onload=function(){e.dispatchMessageToHub(t)},document.body.appendChild(t)}},{key:"dispatchMessageToHub",value:function(e){e.contentWindow.postMessage({PCOPageExpiredCurrentPersonACID:this.currentPersonACID},"*")}},{key:"init",value:function(){var e=this;window.Turbolinks&&window.Turbolinks.supported&&(window.addEventListener("page:load",(function(){return e.createIframe()})),window.addEventListener("turbolinks:load",(function(){return e.createIframe()}))),this.withAlert&&window.addEventListener("message",(function(t){return e.receiveMessageFromHub(t)})),this.createIframe()}},{key:"popSwal",value:function(e){var t=this.swalConfig(e);"object"===_typeof(this.Swal)?this.pcoSwal?this.Swal.alert.fire(t).then((function(){return window.location.reload()})):this.Swal.fire(t).then((function(){return window.location.reload()})):"function"==typeof this.Swal?this.swalV1?this.Swal(t,(function(){return window.location.reload()})):this.swal2v9Plus?this.Swal.fire(t).then((function(){return window.location.reload()})).catch(console.log):this.Swal(t).then((function(){return window.location.reload()})).catch(console.log):(alert(t.text),window.location.reload())}},{key:"receiveMessageFromHub",value:function(e){e.data.hasOwnProperty("PCOPageExpiredCurrentPersonACID")&&e.data.PCOPageExpiredCurrentPersonACID!==this.currentPersonACID&&this.popSwal(e.data.PCOPageExpiredCurrentPersonACID)}},{key:"swalConfig",value:function(e){var t=""===e?this.loggedOutConfig:this.refreshConfig;return"object"===_typeof(this.Swal)&&this.pcoSwal?delete t.icon:"function"==typeof this.Swal&&this.swalV1&&(t.closeOnEsc=!1,t.type=t.icon,delete t.icon),t}}]),e}();window.PCOPageExpired=PCOPageExpired;