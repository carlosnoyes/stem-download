(function(){"use strict";const m={info:(...e)=>console.info(e.join(" ")),warn:(...e)=>console.warn(e.join(" ")),error:(...e)=>console.error(e.join(" "))},y=function(){var t,r,i;let e=document.activeElement;if((t=e.closest(".dropdown"))!=null&&t.querySelector("[data-dropdown-toggle]"))return e.closest(".dropdown").querySelector("[data-dropdown-toggle]");if((r=e.closest("[role='menu']"))!=null&&r.id){const n=(i=e.closest("[role='menu']"))==null?void 0:i.id;return document.querySelector(`[aria-controls="${n}"]`)}return e},g=e=>t=>{if(!e||!t)return;const r=()=>typeof location<"u"&&location&&location.protocol&&location.protocol==="https:"?"https":"http";switch(e){case"production":return`https://${t}.${d()}`;case"staging":return`https://${t}-staging.${d()}`;case"development":let i="test";try{i=location.hostname.match(/\pco\.(\w+)$/)[1]}catch{location.hostname!=="localhost"&&console.error(`${location.hostname} is not a supported dev TLD`)}return`${r()}://${t}.pco.${i}`;case"prototype":return`https://${E()}.${t}.planningcenter.ninja`;case"test":return`${r()}://${t}.pco.test`;default:return`http://${t}.${d()}`}};function l(e,{env:t=v()}={}){return g(t)(e)}const v=()=>{const e=window.location.origin;return e.endsWith("-staging.planningcenteronline.com")||e.endsWith("/staging.planningcenteronline.com")||e.endsWith(".staging.churchcenter.com")||e.endsWith("/staging.churchcenter.com")?"staging":e.endsWith(".planningcenteronline.com")||e.endsWith(".churchcenter.com")||e.endsWith("/churchcenter.com")?"production":e.endsWith(".planningcenter.ninja")||e.endsWith(".churchcenter.ninja")?"prototype":e.endsWith("pco.codes")||e.endsWith("pco.dev")||e.endsWith("pco.test")||e.endsWith("churchcenter.test")?"development":"production"},E=()=>{var e,t;const r=(e=location)==null||(t=e.hostname)==null?void 0:t.match(/(?:www\.)?(.+)\..+\.planningcenter\.ninja/);return r&&r[1]!=="localhost"?r[1]:"main"},d=()=>{const e=location.hostname.match(/planningcenter(online)?.com/);return e===null?"planningcenteronline.com":e[0]};class C{create(t,r={onRemoveData:{}}){const i=this.titleCaseToSnakeCase(t);return window[t]={},window[t].addIframe=function(){const n=document.createElement("iframe");return n.id=`${i}_iframe`,n.height="100%",n.width="100%",n.style.top=0,n.style.left=0,n.frameborder=0,n.seamless="seamless",n.style.position="fixed",n.style.zIndex=99999,n.style.border="0px solid black",n.style.display="none",n.style.opacity=0,document.getElementById(`${i}_overlay`).appendChild(n),n},window[t].addDiv=function(){const n=document.getElementsByTagName("body")[0].appendChild(document.createElement("div"));return n.id=`${i}_overlay`,n.style.height="100%",n.style.width="100%",n.style.position="fixed",n.style.zIndex=99999,n.style.top=0,n.style.left=0,n.style.overflow="hidden",n.style.opacity=1,n.style.background="var(--t-fill-color-transparency-dark-static-040, hsl(0 0% 0% / 0.4))",n},window[t].returnFocus=null,window[t].load=function(n){let c=this.addDiv(),s=this.addIframe();s.src=n,s.addEventListener("load",function(){window[t].returnFocus=y(),s.style.display="block",s.style.opacity=1});const a=function(o){s.parentElement.removeChild(s),c.parentElement.removeChild(c),window.removeEventListener("message",w,!1),document.removeEventListener("keyup",f),typeof INTERFACES<"u"&&INTERFACES!==null&&document.addEventListener("keyup",INTERFACES.modalLayer._dispatchKeyupActions),c=void 0,s=void 0,typeof window[t].afterClose=="function"&&window[t].afterClose(o),window[t].returnFocus&&setTimeout(()=>window[t].returnFocus.focus()),window[t].afterClose=void 0},f=function(o){o.keyCode===27&&a(r.onRemoveData)},h=function(o){return o.data.permitted?!0:(/evernote/i.test(o.data.responseText)||/setImmediate/.test(o.data)||railsEnv==="development"&&m.info(`Message not permitted. Include \`{ permitted: true }\` if you really want to send this message. (data: ${JSON.stringify(o.data)})`),!1)},I=function(o){return o.origin!==l("people")||!h(o)?!1:o.data.redirectUrl&&o.data.redirectUrl.startsWith(l("login"))},w=function(o){I(o)?window.location=o.data.redirectUrl:h(o)&&a(o.data)};return window[t].close=a,window.addEventListener("message",w,!1),typeof INTERFACES<"u"&&INTERFACES!==null&&document.removeEventListener("keyup",INTERFACES.modalLayer._dispatchKeyupActions),document.addEventListener("keyup",f),s},window[t]}titleCaseToSnakeCase(t){const r=[];return t.split(/(?=[^a-z])/).forEach(function(i){return r.push(i.toLowerCase())}),r.join("_")}}const $=new C().create("PersonEditorModal",{onRemoveData:{saved:!1}}),u=()=>{const e=document.createElement("iframe");e.src="https://people.planningcenteronline.com/cross_app/person/precache",e.style.height="0",e.style.width="0",e.style.opacity="0",e.style.position="absolute",e.style.left="-1000px",e.style.top="-1000px",document.getElementsByTagName("body")[0].appendChild(e)};window.addEventListener("load",()=>{window.Turbo&&window.Turbo.supported&&window.addEventListener("turbo:load",u),u()});const p=window.CrossApp||{};p.Person=$,window.CrossApp=p})();
